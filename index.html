<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burger</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <div class="header">
        <div class="header-inner">
            <div class="ellipse"></div>
            <div class="meal">
                <img src="assets/logo.svg" alt="Логотип">
            </div>

            <div class="burgblock">
                <div class="burg11"><img src="assets/pic.svg" alt="Изображение бургера"></div>
                <div class="socnie">
                    <div class="tolko">Только самые <span>сочные бургеры!</span></div>
                    <div class="besplatn">
                        <div class="bes">Бесплатная доставка от 599₽</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="blockscroll">
            <div class="item1">
                <div class="icon"><img src="assets/Бургеры.svg" alt="Бургеры"></div>
                <div class="text">Бургеры</div>
            </div>
            <div class="item">
                <div class="icon"><img src="assets/Закуски.svg" alt="Закуски"></div>
                <div class="text">Закуски</div>
            </div>
            <div class="item">
                <div class="icon"><img src="assets/Комбо.svg" alt="Комбо"></div>
                <div class="text">Комбо</div>
            </div>
            <div class="item">
                <div class="icon"><img src="assets/Шаурма.svg" alt="Шаурма"></div>
                <div class="text">Шаурма</div>
            </div>
            <div class="item">
                <div class="icon"><img src="assets/Пицца.svg" alt="Пицца"></div>
                <div class="text">Пицца</div>
            </div>
        </div>

        <div class="spisokburgerov">
            <div class="burg">Бургеры</div>

            <div class="blcks">
                <!-- Корзина -->
                <div class="threeinone">
                    <div class="korzina">
                        <div class="corz">Корзина</div>
                        <div class="schetchik">
                            <div class="cifr">0</div>
                        </div>
                    </div>
                    <div class="bl1">
                        <!-- Пример товара в корзине -->
                        <div class="srfotoandtext" data-id="0">
                            <div class="sirfoto">
                                <img src="assets/Rectangle 2.png" alt="Супер сырный бургер">
                            </div>
                            <div class="sirtext">
                                <h3 class="sirtext1">Супер сырный</h3>
                                <div class="product-details">
                                    <span class="sirtext2">512г</span>
                                    <span class="sirtext3">550₽</span>
                                </div>
                                <div class="schetch">
                                    <div class="pod">
                                        <button class="minus">-</button>
                                        <span class="cif">1</span>
                                        <button class="plus">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="itog">
                        <div class="itg">Итого:</div>
                        <div class="moneyitog">1279₽</div>
                    </div>

                    <button class="zakazbtn">
                        <div class="textbtn">Оформить заказ</div>
                    </button>

                    <div class="bespdost">
                        <div class="ic">
                            <img src="assets/delivery.png" alt="Иконка доставки">
                        </div>
                        <span class="dstvka">Бесплатная доставка от 599₽</span>
                    </div>
                </div>

                <!-- Блок товаров -->
                <div class="burblock-one-and-two">
                    <!-- Товар 1 -->
                    <div class="burgblock burgblock1" data-id="1" data-name="Супер сырный" data-price="550" data-weight="512">
                        <div class="burgfoto">
                            <img src="assets/photo.svg" alt="Супер сырный бургер">
                        </div>
                        <div class="obed">
                            <div class="ceena">550₽</div>
                            <div class="myasbomb">Супер сырный</div>
                            <div class="gram">512г</div>
                            <button class="dobavitbtn" data-id="1">Добавить</button>
                        </div>
                    </div>

                    <!-- Товар 2 -->
                    <div class="burgblock burgblock2" data-id="2" data-name="Картошка фри" data-price="245" data-weight="180">
                        <div class="burgfoto">
                            <img src="assets/photo-3.svg" alt="Картошка фри">
                        </div>
                        <div class="obed">
                            <div class="ceena">245₽</div>
                            <div class="myasbomb">Картошка фри</div>
                            <div class="gram">180г</div>
                            <button class="dobavitbtn" data-id="2">Добавить</button>
                        </div>
                    </div>
                </div>

                <div class="burblock-three-and-four">
                    <!-- Товар 3 -->
                    <div class="burgblock burgblock3" data-id="3" data-name="Сытный" data-price="639" data-weight="580">
                        <div class="burgfoto">
                            <img src="assets/photo-4.svg" alt="Сытный бургер">
                        </div>
                        <div class="obed">
                            <div class="ceena">639₽</div>
                            <div class="myasbomb">Сытный</div>
                            <div class="gram">580г</div>
                            <button class="dobavitbtn" data-id="3">Добавить</button>
                        </div>
                    </div>

                    <!-- Товар 4 -->
                    <div class="burgblock burgblock4" data-id="4" data-name="Тяжелый удар" data-price="480" data-weight="470">
                        <div class="burgfoto">
                            <img src="assets/photo-5.svg" alt="Тяжелый удар">
                        </div>
                        <div class="obed">
                            <div class="ceena">480₽</div>
                            <div class="supsirniy">Тяжелый удар</div>
                            <div class="gram">470г</div>
                            <button class="dobavitbtn" data-id="4">Добавить</button>
                        </div>
                    </div>
                </div>

                <div class="burblock-five-and-six">
                    <!-- Товар 5 -->
                    <div class="burgblock burgblock5" data-id="5" data-name="Вечная классика" data-price="450" data-weight="450">
                        <div class="burgfoto">
                            <img src="assets/photo-6.svg" alt="Вечная классика">
                        </div>
                        <div class="obed">
                            <div class="ceena">450₽</div>
                            <div class="myasbomb">Вечная классика</div>
                            <div class="gram">450г</div>
                            <button class="dobavitbtn" data-id="5">Добавить</button>
                        </div>
                    </div>

                    <!-- Товар 6 -->
                    <div class="burgblock burgblock6" data-id="6" data-name="Итальянский" data-price="560" data-weight="510">
                        <div class="burgfoto">
                            <img src="assets/photo-7.svg" alt="Итальянский бургер">
                        </div>
                        <div class="obed">
                            <div class="ceena">560₽</div>
                            <div class="supsirniy">Итальянский</div>
                            <div class="gram">510г</div>
                            <button class="dobavitbtn" data-id="6">Добавить</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="footer-inner">
                <div class="logotip">
                    <img src="assets/logo-2.svg" alt="Логотип">
                    <div class="company">© YouMeal, 2022 Design: Anastasia Ilina</div>
                </div>
                <div class="nomer">
                    <div class="nomer-forzakaz">Номер для заказа</div>
                    <div class="num">
                        <div class="iconotnomera"><img src="assets/Call.svg" alt="Телефон"></div>
                        <div class="nome">+7(930)833-38-11</div>
                    </div>
                </div>

                <div class="social-media">
                    <div class="mi">Мы в соцсетях</div>
                    <div class="vktg">
                        <div class="vk">
                            <img src="assets/entypo-social_vk-with-circle.svg" alt="ВКонтакте">
                        </div>
                        <div class="tg">
                            <img src="assets/bi_telegram.svg" alt="Telegram">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    class Cart {
        constructor() {
            this.items = new Map();
            this.loadFromStorage();
            this.initEventListeners();
            this.updateCart(); // Первоначальное обновление корзины
        }

        initEventListeners() {
            // Обработчики для всех кнопок добавления
            document.querySelectorAll('.dobavitbtn').forEach(btn => {
                btn.addEventListener('click', () => this.addItem(btn.dataset.id));
            });

            // Делегирование событий для управления количеством
            document.querySelector('.bl1').addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('minus') || target.classList.contains('plus')) {
                    const action = target.classList.contains('minus') ? -1 : 1;
                    this.updateQuantity(target, action);
                }
            });
        }

        addItem(productId) {
            const product = this.getProductData(productId);
            if (!product) return;

            const existing = this.items.get(productId);
            if (existing) {
                existing.quantity++;
            } else {
                this.items.set(productId, {
                    ...product,
                    quantity: 1
                });
            }

            this.updateCart();
        }

        updateQuantity(btn, delta) {
            const itemElement = btn.closest('.srfotoandtext');
            const productId = itemElement.dataset.id;
            const currentItem = this.items.get(productId);

            if (currentItem) {
                const newQuantity = currentItem.quantity + delta;
                if (newQuantity < 1) {
                    this.items.delete(productId);
                } else {
                    currentItem.quantity = newQuantity;
                }
                this.updateCart();
            }
        }

        getProductData(id) {
            const productCard = document.querySelector(`.burgblock[data-id="${id}"]`);
            if (!productCard) {
                console.error('Товар не найден:', id);
                return null;
            }
            return {
                id,
                name: productCard.dataset.name,
                price: parseInt(productCard.dataset.price),
                image: productCard.querySelector('img').src,
                weight: productCard.dataset.weight
            };
        }

        updateCart() {
            // Обновление счетчика
            const totalCount = Array.from(this.items.values())
                .reduce((sum, item) => sum + item.quantity, 0);
            document.querySelector('.cifr').textContent = totalCount;

            // Обновление общей суммы
            const totalPrice = Array.from(this.items.values())
                .reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.querySelector('.moneyitog').textContent = `${totalPrice}₽`;

            // Обновление списка товаров
            const itemsContainer = document.querySelector('.bl1');
            itemsContainer.innerHTML = '';

            this.items.forEach(item => {
                const itemHTML = `
                    <div class="srfotoandtext" data-id="${item.id}">
                        <div class="sirfoto">
                            <img src="${item.image}" alt="${item.name}">
                        </div>
                        <div class="sirtext">
                            <h3 class="sirtext1">${item.name}</h3>
                            <div class="product-details">
                                <span class="sirtext2">${item.weight}</span>
                                <span class="sirtext3">${item.price}₽</span>
                            </div>
                            <div class="schetch">
                                <div class="pod">
                                    <button class="minus">-</button>
                                    <span class="cif">${item.quantity}</span>
                                    <button class="plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                itemsContainer.insertAdjacentHTML('beforeend', itemHTML);
            });

            this.saveToStorage();
        }

        saveToStorage() {
            const serialized = JSON.stringify(Array.from(this.items.entries()));
            localStorage.setItem('cart', serialized);
        }

        loadFromStorage() {
            const storedData = localStorage.getItem('cart');
            if (storedData) {
                try {
                    const parsed = JSON.parse(storedData);
                    this.items = new Map(parsed.map(([id, item]) => [id, {
                        ...item,
                        price: parseInt(item.price)
                    }]));
                } catch (e) {
                    console.error('Error loading cart:', e);
                }
            }
        }
    }

    // Инициализация корзины при загрузке страницы
    document.addEventListener('DOMContentLoaded', () => {
        window.cart = new Cart();
    });
    </script>
</body>
</html>